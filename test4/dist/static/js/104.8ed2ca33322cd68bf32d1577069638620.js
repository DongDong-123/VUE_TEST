webpackJsonp([104],{AQAW:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=a("3cXf"),s=a.n(o),l=a("fYFQ"),n=a.n(l),i=(a("Kmkn"),{components:{Treeselect:n.a},created:function(){var e=this,t={loginid:"",username:"",dpname:"",roleCode:"",pageSize:this.pageSize,pageNum:this.pageNum,flag:this.searchFlag};t=s()(t),this.axios.post("/system/user/getUserInfo",t,{headers:{"Content-Type":"application/json"}}).then(function(t){console.log(t),t.data&&(e.rowCount=t.data.total),t.data.records&&(e.tableBody=t.data.records)}).catch(function(e){}),this.axios.post("/system/role/Allrole").then(function(t){"200"==t.code&&(e.roleCodes=t.data)}).catch(function(e){}),this.deleteCookies("AmlLtpaToken")},computed:{radioVal:function(){return this.formItem.radio}},watch:{radioVal:function(e){this.roleSelectShow="female3"==e}},data:function(){return{formParamsId:"",menuCodes:this.$store.state.authCodes,pageNum:1,selectLength:0,searchFlag:0,rowCount:0,pageSize:10,roleSelectShow:!1,formItem:{levelId:"",unitIds:null},roleCodes:[],levelIds:[],roleCode:"",selectTreeDates:[],showSelectTreeDates:!1,modal2:!1,data4:[],formValidateModel1:{interest:[],gender:"true",desc:""},checkBox:[],ruleValidateModel1:{interest:[{required:!0,type:"array",min:1,message:"至少请选择色一个",trigger:"change"}],desc:[{type:"string",max:100,message:"长度最大不能超过255",trigger:"blur"}]},modal1:!1,tableHeader:[{name:"操作"},{name:"登录账号"},{name:"真实姓名"},{name:"电话"},{name:"传真"},{name:"手机"},{name:"邮件"},{name:"所属部门"},{name:"用户erp"},{name:"职务"},{name:"状态"},{name:"角色"}],tableBody:[],formValidate:{username:"",realName:"",dpname:"",roleCode:"",flag:"1",pageSize:10,pageNo:"1"},ruleValidate:{username:[{required:!1,message:"",trigger:"blur"}],realName:[{required:!1,message:"",trigger:"blur"}]}}},methods:{download:function(e,t){if(e){var a=window.URL.createObjectURL(new Blob([e])),o=document.createElement("a");o.style.display="none",o.href=a,o.setAttribute("download",t),document.body.appendChild(o),o.click()}},containMenuCode:function(e){var t=!1;return this.menuCodes.forEach(function(a){a.menuCode==e&&(t=!0)}),t},exportFn:function(){var e=this,t={loginid:this.formValidate.username,username:this.formValidate.realName,dpname:this.formValidate.dpname,roleCode:this.formValidate.roleCode,pageSize:this.pageSize,pageNum:1,flag:this.searchFlag};t=s()(t),this.axios.post("/system/user/exportUserInfo",t,{headers:{"Content-Type":"application/json"},responseType:"blob"}).then(function(t){e.download(t,"导出文档.xls")}).catch(function(e){})},sameStep:function(){this.axios.post("/system/getUserRoleUnit").then(function(e){}).catch(function(e){})},deleteCookies:function(e){var t=new Date;t.setTime(t.getTime()-1e4),document.cookie=e+"=0;expires="+t.toGMTString()+";path=/a"},getSelectLength:function(e){this.selectLength=e.length},mode2Save:function(){var e=this;if(0!=this.$refs.tree1.getCheckedNodes().length&&""!=this.formItem.levelId){var t={menu:this.data4,roleCode:this.roleCode,levelId:this.formItem.levelId,unitIds:this.formItem.unitIds};t=s()(t),this.axios.post("/system/role/setRoleAuthView",t,{headers:{"Content-Type":"application/json"}}).then(function(t){"200"==t.code&&(e.$Message.success("保存成功"),setTimeout(function(){e.modal2=!1},2e3))}).catch(function(e){})}else this.$Message.warning("操作权限和数据权限至少各选中一项")},updateShowSelectTreeDates:function(e){for(var t=0;t<this.levelIds.length;t++)if(this.levelIds[t].code==e)return void(this.showSelectTreeDates=this.levelIds[t].flag)},pageSizefun:function(e){this.pageSize=1*e,1==this.pageNum&&this.pageChange(1)},pageChange:function(e){this.pageNum=1*e;var t=this,a={loginid:this.formValidate.username,username:this.formValidate.realName,dpname:this.formValidate.dpname,roleCode:this.formValidate.roleCode,pageSize:this.pageSize,pageNum:this.pageNum,flag:this.searchFlag};a=s()(a),this.axios.post("/system/user/getUserInfo",a,{headers:{"Content-Type":"application/json"}}).then(function(e){console.log(e),e.data&&(t.rowCount=e.data.total),e.data.records&&(t.tableBody=e.data.records)}).catch(function(e){})},handleSubmit:function(e){this.searchFlag=1*e;var t=this,a={loginid:this.formValidate.username,username:this.formValidate.realName,dpname:this.formValidate.dpname,roleCode:this.formValidate.roleCode,pageSize:this.pageSize,pageNum:1,flag:this.searchFlag};a=s()(a),this.axios.post("/system/user/getUserInfo",a,{headers:{"Content-Type":"application/json"}}).then(function(e){e.data&&(t.rowCount=e.data.total),e.data.records&&(t.tableBody=e.data.records)}).catch(function(e){})},watchfun:function(){this.$router.push({name:"dataExtractionApplyDetail"})},roleSet:function(e){this.formParamsId=e,this.modal1=!0;var t=this,a={loginid:e};a=s()(a),this.axios.post("/system/user/getUserRoleInfo",a,{headers:{"Content-Type":"application/json"}}).then(function(e){"200"==e.code&&(t.formValidateModel1.interest=e.data.roleCodes,t.formValidateModel1.gender=e.data.status,t.formValidateModel1.desc=e.data.remarks,t.checkBox=e.data.allRoles)}).catch(function(e){})},selectTreeCleanUp:function(e){for(var t=0;t<e.length;t++)e[t].children&&e[t].children.length>0?this.selectTreeCleanUp(e[t].children):this.$delete(e[t],"children")},saveFun:function(e){var t=this;this.$refs[e].validate(function(e){if(e){var a={roleCodes:t.formValidateModel1.interest,status:t.formValidateModel1.gender,remarks:t.formValidateModel1.desc,loginid:t.formParamsId};a=s()(a),t.axios.post("/system/user/saveUserRole",a,{headers:{"Content-Type":"application/json"}}).then(function(e){200==e.code&&(t.$Message.success("保存成功"),t.modal1=!1,t.handleSubmit("0"))}).catch(function(e){})}})},del:function(){var e=this;this.modal_loading=!0,setTimeout(function(){e.modal_loading=!1,e.modal2=!1,e.$Message.success("Successfully delete")},2e3)},roleSelectFun:function(e){this.roleCode=e;var t=this,a=new FormData;a.append("roleCode",e),this.axios.post("/system/role/getRoleAuthView",a,{headers:{"Content-Type":"multipart/form-data"}}).then(function(e){"200"==e.code&&(t.data4=e.data.menu,t.formItem=e.data.roleChecked,t.levelIds=e.data.level,t.selectTreeDates=e.data.unitTree,t.selectTreeCleanUp(t.selectTreeDates),t.levelIds.forEach(function(e){e.code==t.formItem.levelId&&(t.showSelectTreeDates=e.flag)}))}).catch(function(e){}),this.modal2=!0}}}),r={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"topTitle"},[a("span",{staticClass:"topTitle-span1"},[e._v("系统管理")]),e._v(" "),e._m(0),e._v(" "),a("span",{staticClass:"topTitle-span1"},[e._v("用户权限")]),e._v(" "),e._m(1),e._v(" "),a("span",{staticClass:"topTitle-span1"},[e._v("用户管理")]),e._v(" "),a("div",{staticClass:"button-content"},[a("Button",{attrs:{type:"primary"},on:{click:e.exportFn}},[a("i",{staticClass:"ivu-icon ivu-icon-md-arrow-up"}),e._v("导出\n          ")]),e._v(" "),a("Button",{attrs:{type:"primary"},on:{click:e.sameStep}},[a("i",{staticClass:"ivu-icon ivu-icon-md-arrow-up"}),e._v("数据同步\n          ")])],1)]),e._v(" "),a("div",{staticClass:"contentCellBox"},[a("div",{staticClass:"contentCellBox"},[e._m(2),e._v(" "),a("div",{staticClass:"contentCellBox"},[a("Form",{attrs:{model:e.formValidate,"label-width":120,inline:""}},[a("Row",[a("FormItem",{attrs:{label:"登录账号",prop:"username"}},[a("Input",{staticStyle:{width:"200px"},attrs:{placeholder:"请输入登录账号"},model:{value:e.formValidate.username,callback:function(t){e.$set(e.formValidate,"username",t)},expression:"formValidate.username"}})],1),e._v(" "),a("FormItem",{attrs:{label:"真实姓名",prop:"realName"}},[a("Input",{staticStyle:{width:"200px"},attrs:{placeholder:"请输入真实姓名"},model:{value:e.formValidate.realName,callback:function(t){e.$set(e.formValidate,"realName",t)},expression:"formValidate.realName"}})],1),e._v(" "),a("FormItem",{attrs:{label:"所属部门"}},[a("Input",{staticStyle:{width:"200px"},attrs:{placeholder:"请输入所属部门"},model:{value:e.formValidate.dpname,callback:function(t){e.$set(e.formValidate,"dpname",t)},expression:"formValidate.dpname"}})],1),e._v(" "),a("FormItem",{attrs:{label:"角色"}},[a("Select",{staticStyle:{width:"200px"},model:{value:e.formValidate.roleCode,callback:function(t){e.$set(e.formValidate,"roleCode",t)},expression:"formValidate.roleCode"}},[a("Option",{attrs:{value:""}},[e._v("请选择")]),e._v(" "),e._l(e.roleCodes,function(t){return a("Option",{key:t.roleCode,attrs:{value:t.roleCode}},[e._v(e._s(t.roleName))])})],2)],1)],1),e._v(" "),a("Row",[a("div",{staticClass:"btnClass"},[a("Button",{attrs:{type:"primary"},on:{click:function(t){return e.handleSubmit("0")}}},[e._v("查询")]),e._v(" "),a("Button",{attrs:{type:"primary"},on:{click:function(t){return e.handleSubmit("1")}}},[e._v("精确查询")])],1)])],1)],1)]),e._v(" "),a("div",{staticClass:"contentCellBox"},[e._m(3),e._v(" "),a("div",{staticClass:"contentCellBody"},[a("Row",[a("table",{staticClass:"tableBox"},[a("thead",[a("tr",[a("td",[e._v("序号")]),e._v(" "),e._l(e.tableHeader,function(t,o){return a("td",[e._v(e._s(t.name))])})],2)]),e._v(" "),a("tbody",e._l(e.tableBody,function(t,o){return a("tr",{attrs:{id:t.id}},[a("td",[e._v(e._s(e.pageSize*(e.pageNum-1)+o+1))]),e._v(" "),e._l(t.arr,function(o,s){return["1"==o.flag?a("td",[e._v(e._s(o.var))]):e._e(),e._v(" "),"3"==o.flag&&e.containMenuCode("112003001004")?a("td",{on:{click:function(a){return e.roleSet(t.id)}}},[a("span",{staticClass:"spanBox"},[e._v(e._s(o.var))])]):e._e(),e._v(" "),"3"!=o.flag||e.containMenuCode("112003001004")?"2"==o.flag&&e.containMenuCode("112003001002")?a("td",e._l(o.var,function(t,o){return a("p",{staticClass:"roleBox",on:{click:function(a){return e.roleSelectFun(t.roleCode)}}},[a("span",[e._v(e._s(t.roleName))])])}),0):e._e():a("td",[a("span",{staticClass:"spanBox"})]),e._v(" "),"2"!=o.flag||e.containMenuCode("112003001002")?e._e():a("td",e._l(o.var,function(t,o){return a("p",[a("span",[e._v(e._s(t.roleName))])])}),0)]})],2)}),0)])]),e._v(" "),a("div",{staticClass:"flexCenter pageBox"},[a("Page",{attrs:{current:e.pageNum,total:e.rowCount,"page-size":e.pageSize,"show-elevator":"","show-sizer":""},on:{"update:current":function(t){e.pageNum=t},"on-change":e.pageChange,"on-page-size-change":e.pageSizefun}})],1)],1)])]),e._v(" "),a("Modal",{staticClass:"dialog",attrs:{"mask-closable":!1,width:"1000",title:"用户管理"},model:{value:e.modal1,callback:function(t){e.modal1=t},expression:"modal1"}},[a("div",[a("Form",{ref:"formValidateModel1",attrs:{model:e.formValidateModel1,rules:e.ruleValidateModel1,"label-width":80}},[a("FormItem",{attrs:{label:"角色",prop:"interest"}},[a("CheckboxGroup",{model:{value:e.formValidateModel1.interest,callback:function(t){e.$set(e.formValidateModel1,"interest",t)},expression:"formValidateModel1.interest"}},e._l(e.checkBox,function(t,o){return a("Checkbox",{key:o,attrs:{label:t.roleCode}},[e._v(e._s(t.roleName))])}),1)],1),e._v(" "),a("FormItem",{attrs:{label:"状态"}},[a("RadioGroup",{model:{value:e.formValidateModel1.gender,callback:function(t){e.$set(e.formValidateModel1,"gender",t)},expression:"formValidateModel1.gender"}},[a("Radio",{attrs:{label:"true"}},[e._v("启用")]),e._v(" "),a("Radio",{attrs:{label:"false"}},[e._v("停用")])],1)],1),e._v(" "),a("FormItem",{attrs:{label:"说明",prop:"desc"}},[a("Input",{attrs:{type:"textarea",autosize:{minRows:2,maxRows:5},placeholder:"请输入..."},model:{value:e.formValidateModel1.desc,callback:function(t){e.$set(e.formValidateModel1,"desc",t)},expression:"formValidateModel1.desc"}})],1)],1)],1),e._v(" "),a("div",{staticClass:"flexCenter",attrs:{slot:"footer"},slot:"footer"},[a("div",{staticClass:"button-content"},[a("Button",{attrs:{type:"primary"},on:{click:function(t){return e.saveFun("formValidateModel1")}}},[e._v("保存")]),e._v(" "),a("Button",{staticStyle:{"margin-left":"8px"},on:{click:function(t){e.modal1=!1}}},[e._v("取消")])],1)])]),e._v(" "),a("Modal",{staticClass:"dialog",attrs:{"mask-closable":!1,width:"1000",title:"权限"},model:{value:e.modal2,callback:function(t){e.modal2=t},expression:"modal2"}},[a("div",{staticClass:"jurisdictionModal flexStart"},[a("div",{staticClass:"jurisdictionModal-1"},[a("Tree",{ref:"tree1",attrs:{data:e.data4,"show-checkbox":"",multiple:""},on:{"on-check-change":e.getSelectLength}})],1),e._v(" "),a("div",{staticClass:"jurisdictionModal-2"},[a("div",{staticClass:"jurisdictionModal-2-1"},[e._v("数据权限")]),e._v(" "),a("div",{staticClass:"jurisdictionModal-2-2"},[a("Form",{attrs:{model:e.formItem,"label-width":80}},[a("FormItem",{attrs:{label:""}},[a("RadioGroup",{on:{"on-change":e.updateShowSelectTreeDates},model:{value:e.formItem.levelId,callback:function(t){e.$set(e.formItem,"levelId",t)},expression:"formItem.levelId"}},e._l(e.levelIds,function(t){return a("Radio",{key:t.code,attrs:{label:t.code}},[e._v(e._s(t.name))])}),1)],1),e._v(" "),a("FormItem",{attrs:{label:""}},[e.showSelectTreeDates?a("treeselect",{staticStyle:{position:"absolute",top:"15px",left:"0px"},attrs:{multiple:!0,options:e.selectTreeDates},model:{value:e.formItem.unitIds,callback:function(t){e.$set(e.formItem,"unitIds",t)},expression:"formItem.unitIds"}}):e._e()],1)],1)],1)])]),e._v(" "),a("div",{staticClass:"flexCenter button-content",staticStyle:{margin:"0"},attrs:{slot:"footer"},slot:"footer"},[a("Button",{attrs:{type:"primary"},on:{click:e.mode2Save}},[e._v("保存")]),e._v(" "),a("Button",{staticStyle:{"margin-left":"8px"},on:{click:function(t){e.modal2=!1}}},[e._v("取消")])],1)])],1)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("span",{staticClass:"topTitle-span1"},[t("img",{attrs:{src:a("Dh6M"),alt:""}})])},function(){var e=this.$createElement,t=this._self._c||e;return t("span",{staticClass:"topTitle-span1"},[t("img",{attrs:{src:a("Dh6M"),alt:""}})])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"contentCellTitle"},[t("div",{staticClass:"contentCellTitle-1"}),this._v("查询条件\n      ")])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"contentCellTitle"},[t("div",{staticClass:"contentCellTitle-1"}),this._v("数据列表\n      ")])}]};var d=a("C7Lr")(i,r,!1,function(e){a("CXo7")},"data-v-3771bfee",null);t.default=d.exports},CXo7:function(e,t){}});
//# sourceMappingURL=104.8ed2ca33322cd68bf32d1577069638620.js.map