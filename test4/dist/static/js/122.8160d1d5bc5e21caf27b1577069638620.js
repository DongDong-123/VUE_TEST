webpackJsonp([122],{cDYe:function(t,e){},qrbU:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s={mounted:function(){this.handleSubmit(0,1),this.getDic()},data:function(){return{percentWidth:"40%",tableHeader:[{name:"序"},{name:"操作"},{name:"任务编号"},{name:"任务创建时间"},{name:"数据开始时间"},{name:"数据截止时间"},{name:"执行状态"},{name:"执行开始时间"},{name:"执行结束时间"}],mapStatus:{0:"等待",1:"运行中",2:"运行成功",3:"运行失败"},tableBody:[],pageSize:10,pageNum:1,rowCount:0,currentpage:1,keyId:"",modelTitle:"强制更改",tabview:"",showModal:!1,dataObj:{type:"1"},stepNameList:[],formValidate:{stepNum:"",status:""},ruleValidate:{stepNum:[{required:!1,validator:function(t,e,a){e&&(/[^\d]/g.test(e)?a(new Error("任务编号只能为数字")):a()),a()},trigger:"blur"}]}}},methods:{getDic:function(){var t=this;this.axios.get("/system/getDic/STEP_STATUS").then(function(e){"200"==e.code&&(t.stepNameList=e.data.STEP_STATUS)}).catch(function(t){})},handleSubmit:function(t,e){var a=this;this.pageNum=e;var s={ifExacte:t,stepNum:this.formValidate.stepNum,status:this.formValidate.status,page:{pageNum:e,pageSize:this.pageSize}};this.$refs.formValidate.validate(function(t){t&&a.axios.post("/system/taskStep/list",s,{headers:{"Content-Type":"application/json"}}).then(function(t){"200"==t.code&&(a.tableBody=t.data.content,a.rowCount=t.data.totalSize)}).catch(function(t){})})},pageSizefun:function(t){this.pageSize=1*t,this.handleSubmit(0,1)},pageChange:function(t){this.pageNum=t,this.handleSubmit(0,t)},operate:function(t,e){var a=this;switch(t){case"4":this.$Modal.confirm({title:"是否强制更改？",okText:"确认",cancelText:"取消",onOk:function(){a.forceUpdate(e)},onCancel:function(){}});break;case"5":this.$Modal.confirm({title:"是否重新执行？",okText:"确认",cancelText:"取消",onOk:function(){a.retryItem(e)},onCancel:function(){}})}},forceUpdate:function(t){var e=this;this.axios.post("/system/taskStep/focus/"+t.step_num,{headers:{"Content-Type":"application/json"}}).then(function(t){"200"==t.code&&(e.$Message.success("更改成功！"),e.handleSubmit(0,e.pageNum))}).catch(function(t){})},retryItem:function(t){var e=this;console.log("item",t),t.task_id&&this.axios.post("/system/taskStep/retry/"+t.task_id,{headers:{"Content-Type":"application/json"}}).then(function(t){"200"==t.code&&(e.$Message.success("执行成功！"),e.handleSubmit(0,e.pageNum))}).catch(function(t){console.log(t)})},saveDatas:function(){this.showModal=!1,this.handleSubmit(0,this.pageNum)},cancelDialog:function(t){this.showModal=t,this.cancel()},cancel:function(){this.$refs.dialogModal.$refs.formValidate&&this.$refs.dialogModal.$refs.formValidate.resetFields()}}},n={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[t._m(0),t._v(" "),a("div",{staticClass:"contentCellBox"},[a("div",{staticClass:"contentCellBox"},[t._m(1),t._v(" "),a("div",{staticClass:"contentCellBody1"},[a("Form",{ref:"formValidate",attrs:{model:t.formValidate,rules:t.ruleValidate,"label-width":120,inline:""}},[a("Row",[a("FormItem",{attrs:{label:"任务编号：",prop:"stepNum"}},[a("Input",{staticStyle:{width:"200px"},attrs:{placeholder:"请输入任务编号"},model:{value:t.formValidate.stepNum,callback:function(e){t.$set(t.formValidate,"stepNum",e)},expression:"formValidate.stepNum"}})],1),t._v(" "),a("FormItem",{attrs:{label:"执行状态：",prop:"status"}},[a("Select",{staticStyle:{width:"200px"},model:{value:t.formValidate.status,callback:function(e){t.$set(t.formValidate,"status",e)},expression:"formValidate.status"}},[a("Option",{attrs:{value:""}},[t._v("请选择")]),t._v(" "),t._l(t.stepNameList,function(e){return a("Option",{key:e.code,attrs:{value:e.code}},[t._v(t._s(e.name))])})],2)],1),t._v(" "),a("Row",[a("div",{staticClass:"btnClass"},[a("Button",{attrs:{type:"primary"},on:{click:function(e){return t.handleSubmit(0,1)}}},[t._v("查询")])],1)])],1)],1),t._v(" "),a("div",{staticClass:"contentCellBody"},[t._m(2),t._v(" "),a("Row",[a("table",{staticClass:"tableBox"},[a("thead",[a("tr",t._l(t.tableHeader,function(e,s){return a("td",[t._v(t._s(e.name))])}),0)]),t._v(" "),a("tbody",[t._l(t.tableBody,function(e,s){return a("tr",{attrs:{id:e.documentId}},[a("td",[t._v("\n                      "+t._s(t.pageSize*(t.pageNum-1)+s+1)+"\n                    ")]),t._v(" "),a("td",{staticClass:"noWrap"},[a("button",{staticClass:"buttonCls spanBox",attrs:{disabled:"1"==e.status},on:{click:function(a){return t.operate("4",e)}}},[t._v("强制更改")]),t._v(" "),a("button",{staticClass:"buttonCls spanBox",attrs:{disabled:"1"==e.status},on:{click:function(a){return t.operate("5",e)}}},[t._v("重新执行")])]),t._v(" "),a("td",[t._v(t._s(e.step_num))]),t._v(" "),a("td",[t._v(t._s(e.step_create_time))]),t._v(" "),a("td",[t._v(t._s(e.date_from))]),t._v(" "),a("td",[t._v(t._s(e.date_to))]),t._v(" "),a("td",[t._v(t._s(t.mapStatus[e.status]))]),t._v(" "),a("td",[t._v(t._s(e.exec_time1))]),t._v(" "),a("td",[t._v(t._s(e.exec_time2))])])})],2)])])],1),t._v(" "),a("div",{staticClass:"flexCenter pageBox"},[a("Page",{attrs:{total:t.rowCount,"page-size":t.pageSize,current:t.currentpage,"show-elevator":"","show-sizer":""},on:{"on-change":t.pageChange,"on-page-size-change":t.pageSizefun,"update:current":function(e){t.currentpage=e}}})],1)],1)])])])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"topTitle"},[e("span",{staticClass:"topTitle-span1"},[this._v("系统管理")]),this._v(" "),e("span",{staticClass:"topTitle-span1"},[e("img",{attrs:{src:a("Dh6M"),alt:""}})]),this._v(" "),e("span",{staticClass:"topTitle-span1"},[this._v("数据集成")]),this._v(" "),e("span",{staticClass:"topTitle-span1"},[e("img",{attrs:{src:a("Dh6M"),alt:""}})]),this._v(" "),e("span",{staticClass:"topTitle-span1"},[this._v("流程步骤")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"contentCellTitle"},[e("div",{staticClass:"contentCellTitle-1"}),this._v("查询条件\n      ")])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"contentCellTitle"},[e("div",{staticClass:"contentCellTitle-1"}),this._v("数据列表\n          ")])}]};var i=a("C7Lr")(s,n,!1,function(t){a("cDYe")},"data-v-1664814f",null);e.default=i.exports}});
//# sourceMappingURL=122.8160d1d5bc5e21caf27b1577069638620.js.map