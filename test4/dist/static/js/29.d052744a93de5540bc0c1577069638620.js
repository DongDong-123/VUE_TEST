webpackJsonp([29],{Dj59:function(t,e){},qKQn:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("3cXf"),s=a.n(i),n=a("lvfI"),o={components:{showUsualFiles:n.a},props:["dataObj"],data:function(){return{buttonDisabled:!1,fileObj:{},uploadList:[],fileId:"",formValidate:{title:"",pubOrg:"",pubTime:"",ifShow:!1,content:"",attachId:""},pubOrgDatas:[],index:1,ruleValidate:{title:[{required:!0,message:"标题不能为空！",trigger:"blur"},{max:125,message:"输入长度过长",trigger:"blur"}],pubOrg:[{required:!0,message:"发布机构不能为空！",trigger:"change"}],pubTime:[{required:!0,message:"发布时间不能为空！",trigger:"change"}],content:[{required:!1,message:"编辑内容不能超过1000字",trigger:"blur",max:1e3}]}}},created:function(){if(!(this.pubOrgDatas.length>0)&&this.getDic(),"2"==this.dataObj.type){var t=this.dataObj.data;t&&t.id&&this.getInfInfoRow(t.id)}else this.fileObj={data:[],showFlag:!0}},mounted:function(){},methods:{receiveUploadList:function(t){var e=this;this.uploadList=[],t.forEach(function(t){e.uploadList.push(t.url)}),this.formValidate.attachId=this.uploadList,console.log("receiveUploadlist",this.uploadList)},getInfInfoRow:function(t){var e=this;this.axios.post("/process/infInfo/getInfInfoRow/"+t,{headers:{"Content-Type":"application/json"}}).then(function(t){if("200"==t.code){var a=t.data;e.formValidate={attachId:a.attachId,title:a.title,pubOrg:a.pubOrg,pubTime:a.pubTime,ifShow:"true"==a.ifShow,content:a.content,id:a.id},e.fileObj={data:a,showFlag:!0},e.fileId=a.busId}}).catch(function(t){})},getDic:function(){var t=this;this.axios.get("/system/getDic/PROCESS_PUB_ORG").then(function(e){"200"==e.code&&(t.pubOrgDatas=e.data.PROCESS_PUB_ORG)}).catch(function(t){})},changeUseSts:function(t){this.formValidate.ifShow=t},handleSubmit:function(t){var e=this;console.log(this.formValidate),this.$refs[t].validate(function(t){t&&("1"==e.dataObj.type?(e.buttonDisabled=!0,e.axios.post("/process/infInfo/addInfInfo",e.formValidate,{headers:{"Content-Type":"application/json"}}).then(function(t){"200"==t.code&&(e.buttonDisabled=!1,e.$emit("save"),e.$Message.success("保存成功！"))}).catch(function(t){e.buttonDisabled=!1})):(e.buttonDisabled=!0,e.axios.post("/process/infInfo/updateInfInfo",e.formValidate,{headers:{"Content-Type":"application/json"}}).then(function(t){"200"==t.code&&(e.buttonDisabled=!1,e.$Message.success("修改成功！"),e.$emit("save"))}).catch(function(t){e.buttonDisabled=!1})))})},handleCancel:function(t){this.$emit("cancel",!1)}}},l={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"add-reg-manage"},[a("Form",{ref:"formValidate",staticClass:"form-content",attrs:{model:t.formValidate,rules:t.ruleValidate,"label-width":100}},[a("FormItem",{attrs:{label:"标题",prop:"title"}},[a("Input",{attrs:{placeholder:"请输入标题"},model:{value:t.formValidate.title,callback:function(e){t.$set(t.formValidate,"title",e)},expression:"formValidate.title"}})],1),t._v(" "),a("FormItem",{attrs:{label:"是否公开"}},[a("i-switch",{on:{"on-change":function(e){return t.changeUseSts(t.formValidate.ifShow)}},model:{value:t.formValidate.ifShow,callback:function(e){t.$set(t.formValidate,"ifShow",e)},expression:"formValidate.ifShow"}},[a("span",{attrs:{slot:"open"},slot:"open"},[t._v("是")]),t._v(" "),a("span",{attrs:{slot:"close"},slot:"close"},[t._v("否")])])],1),t._v(" "),a("FormItem",{attrs:{label:"发布机构",prop:"pubOrg"}},[a("Select",{attrs:{placeholder:"请输入发布机构"},model:{value:t.formValidate.pubOrg,callback:function(e){t.$set(t.formValidate,"pubOrg",e)},expression:"formValidate.pubOrg"}},[a("Option",{attrs:{value:""}},[t._v("未选择")]),t._v(" "),t._l(t.pubOrgDatas,function(e){return a("Option",{key:e.code,attrs:{value:e.code}},[t._v(t._s(e.name))])})],2)],1),t._v(" "),a("FormItem",{attrs:{label:"发布时间",prop:"pubTime"}},[a("DatePicker",{attrs:{type:"date",placeholder:"请选择发布时间",value:t.formValidate.pubTime},on:{"on-change":function(e){t.formValidate.pubTime=e}}})],1),t._v(" "),a("FormItem",{attrs:{label:"编辑内容",prop:"content"}},[a("Input",{attrs:{type:"textarea",autosize:{minRows:2,maxRows:5},placeholder:"请输入编辑内容"},model:{value:t.formValidate.content,callback:function(e){t.$set(t.formValidate,"content",e)},expression:"formValidate.content"}})],1),t._v(" "),a("FormItem",{attrs:{label:"附件"}},[a("showUsualFiles",{key:t.fileId,attrs:{"file-obj":t.fileObj},on:{requestUploadList:t.receiveUploadList}})],1),t._v(" "),a("FormItem",[a("div",{staticClass:"button-content mL_0"},[a("Button",{attrs:{type:"primary",disabled:t.buttonDisabled},on:{click:function(e){return t.handleSubmit("formValidate")}}},[t._v("保存")]),t._v(" "),a("Button",{on:{click:t.handleCancel}},[t._v("取消")])],1)])],1)],1)},staticRenderFns:[]};var r={created:function(){this.getDic(),this.handleSubmit(0,1)},computed:{},components:{addInfoManage:a("C7Lr")(o,l,!1,function(t){a("Dj59")},null,null).exports,infoManageDetail:a("t7l9").a,showUsualFiles:n.a},watch:{},data:function(){return{ifExacte:0,percentWidth:"60%",keyId:"",modelTitle:"新增",tabview:"addInfoManage",showModal:!1,dataObj:{type:"1",data:[],showFlag:!0},pubOrgDatas:[],pageSize:10,pageNum:1,rowCount:0,currentpage:1,formValidate:{pubOrg:"",title:"",permissionTime:["",""]},tableHeader:[{name:"序"},{name:"操作"},{name:"标题"},{name:"是否公开"},{name:"编辑内容"},{name:"附件"},{name:"发布时间"},{name:"发布机构"},{name:"创建日期"},{name:"创建人员"},{name:"更新时间"},{name:"更新人"}],tableBody:[]}},methods:{exportsFile:function(){var t=this,e={ifExacte:this.ifExacte,minPubTime:this.formValidate.permissionTime[0],maxPubTime:this.formValidate.permissionTime[1],pubOrg:this.formValidate.pubOrg?this.formValidate.pubOrg:"",pageNum:this.pageNum,title:this.formValidate.title.trim(),pageSize:this.pageSize};e=s()(e),this.axios.post("/process/infInfo/getInfInfoExcelList",e,{headers:{"Content-Type":"application/json"},responseType:"blob"}).then(function(e){t.download(e,"导出文档.xls")}).catch(function(t){})},download:function(t,e){if(t){var a=window.URL.createObjectURL(new Blob([t],{type:"application/vnd.ms-excel"})),i=document.createElement("a");i.style.display="none",i.href=a,i.setAttribute("download",e),document.body.appendChild(i),i.click()}},watchFiles:function(t){this.percentWidth="40%",this.modelTitle="文件列表",this.tabview="showUsualFiles",this.showModal=!0,this.keyId=t.busId,this.dataObj={data:t,showFlag:!1}},pageSizefun:function(t){this.pageSize=1*t,this.handleSubmit(0,1)},pageChange:function(t){this.pageNum=t,this.handleSubmit(0,t)},handleSubmit:function(t,e){var a=this,i={ifExacte:t,minPubTime:this.formValidate.permissionTime[0],maxPubTime:this.formValidate.permissionTime[1],pubOrg:this.formValidate.pubOrg?this.formValidate.pubOrg:"",pageNum:e,title:this.formValidate.title.trim(),pageSize:this.pageSize};console.log("data",i),this.axios.post("/process/infInfo/getInfInfoList",i,{headers:{"Content-Type":"application/json"}}).then(function(t){"200"==t.code&&(a.tableBody=t.data.records,a.tableBody.forEach(function(t){t.createTime=t.createTime.substr(0,19),t.updateTime=t.updateTime.substr(0,19)}),a.rowCount=t.data.total)}).catch(function(t){})},getDic:function(){var t=this;this.axios.get("/system/getDic/PROCESS_PUB_ORG").then(function(e){"200"==e.code&&(t.pubOrgDatas=e.data.PROCESS_PUB_ORG)}).catch(function(t){})},deleteItem:function(t){var e=this;console.log("item",t),t.id&&this.axios.post("/process/infInfo/deleteInfInfo",{id:t.id},{headers:{"Content-Type":"application/json"}}).then(function(t){e.$Message.success("删除成功！"),e.handleSubmit(0,1),e.currentpage=1,e.pageNum=1}).catch(function(t){console.log(t)})},operate:function(t,e){var a=this;switch(t){case"1":this.keyId=!this.keyId,this.percentWidth="60%",this.modelTitle="新增",this.tabview="addInfoManage",this.showModal=!0,this.dataObj={type:1,data:[],showFlag:!0};break;case"2":this.keyId=e.id,this.percentWidth="60%",this.modelTitle="修改",this.dataObj={type:2,data:e,showFlag:!0},this.tabview="addInfoManage",this.showModal=!0;break;case"3":this.$Modal.confirm({title:"是否删除？",okText:"确认",cancelText:"取消",onOk:function(){a.deleteItem(e)},onCancel:function(){}});break;case"4":this.percentWidth="50%",this.keyId=e.id,this.modelTitle="详情",this.dataObj={type:4,data:e,showFlag:!1},this.tabview="infoManageDetail",this.showModal=!0}},saveDatas:function(){this.showModal=!1,this.pageNum=1,this.currentpage=1,this.handleSubmit(0,1),this.cancel()},cancelDialog:function(t){this.showModal=t,this.cancel()},cancel:function(){this.$refs.dialogModal.$refs.formValidate&&(this.$refs.dialogModal.$refs.formValidate.resetFields(),this.keyId=!this.keyId)}}},c={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"topTitle"},[a("span",{staticClass:"topTitle-span1"},[t._v("过程管理")]),t._v(" "),t._m(0),t._v(" "),a("span",{staticClass:"topTitle-span1"},[t._v("信息库管理")]),t._v(" "),a("div",{staticClass:"button-content"},[a("Button",{attrs:{type:"primary"},on:{click:function(e){return t.operate("1")}}},[a("i",{staticClass:"ivu-icon ivu-icon-md-add"}),t._v("新增\n      ")]),t._v(" "),a("Button",{directives:[{name:"authcontrol",rawName:"v-authcontrol",value:{menuCode:"108001006004"},expression:"{menuCode:'108001006004'}"}],attrs:{type:"primary"},on:{click:t.exportsFile}},[a("i",{staticClass:"ivu-icon ivu-icon-md-arrow-up"}),t._v("导出\n      ")])],1)]),t._v(" "),a("div",{staticClass:"contentCellBox"},[a("div",{staticClass:"contentCellBox"},[t._m(1),t._v(" "),a("div",{staticClass:"contentCellBody1"},[a("Form",{ref:"formValidate",attrs:{model:t.formValidate,"label-width":120,inline:""}},[a("FormItem",{attrs:{label:"标题："}},[a("Input",{staticStyle:{width:"200px"},attrs:{placeholder:"请输入标题"},model:{value:t.formValidate.title,callback:function(e){t.$set(t.formValidate,"title",e)},expression:"formValidate.title"}})],1),t._v(" "),a("FormItem",{attrs:{label:"发布时间："}},[a("DatePicker",{staticStyle:{width:"200px"},attrs:{type:"daterange",placeholder:"请选择发布时间",value:t.formValidate.permissionTime},on:{"on-change":function(e){t.formValidate.permissionTime=e}}})],1),t._v(" "),a("FormItem",{attrs:{label:"发布机构："}},[a("Select",{staticStyle:{width:"200px"},attrs:{placeholder:"请选择发布机构"},model:{value:t.formValidate.pubOrg,callback:function(e){t.$set(t.formValidate,"pubOrg",e)},expression:"formValidate.pubOrg"}},[a("Option",{attrs:{value:""}},[t._v("未选择")]),t._v(" "),t._l(t.pubOrgDatas,function(e){return a("Option",{key:e.code,attrs:{value:e.code}},[t._v(t._s(e.name))])})],2)],1),t._v(" "),a("Row",[a("div",{staticClass:"btnClass"},[a("Button",{staticStyle:{width:"89px"},attrs:{type:"primary"},on:{click:function(e){return t.handleSubmit(0,1)}}},[t._v("查询")]),t._v(" "),a("Button",{staticStyle:{"margin-left":"10px"},attrs:{type:"primary"},on:{click:function(e){return t.handleSubmit(1,1)}}},[t._v("精确查询")])],1)])],1),t._v(" "),a("div",{staticClass:"contentCellBody"},[t._m(2),t._v(" "),a("Row",[a("table",{staticClass:"tableBox"},[a("thead",[a("tr",t._l(t.tableHeader,function(e,i){return a("td",[t._v(t._s(e.name))])}),0)]),t._v(" "),a("tbody",[t._l(t.tableBody,function(e,i){return a("tr",{attrs:{id:e.documentId}},[a("td",[t._v("\n                      "+t._s(t.pageSize*(t.pageNum-1)+i+1)+"\n                    ")]),t._v(" "),a("td",{staticClass:"noWrap"},[a("span",{staticClass:"spanBox",on:{click:function(a){return t.operate("2",e)}}},[t._v("修改")]),t._v(" "),a("span",{staticClass:"spanBox",on:{click:function(a){return t.operate("3",e)}}},[t._v("删除")])]),t._v(" "),a("td",[a("el-popover",{attrs:{placement:"top-start",title:"",width:"200",trigger:"hover",content:e.title}},[a("span",{staticClass:"spanBox disBlock textOverflow textMaxWidth",attrs:{slot:"reference"},on:{click:function(a){return t.operate("4",e)}},slot:"reference"},[t._v(t._s(e.title))])])],1),t._v(" "),a("td",[t._v(t._s("true"==e.ifShow?"是":"否"))]),t._v(" "),a("td",[a("el-popover",{attrs:{placement:"top-start",title:"",width:"200",trigger:"hover",content:e.content}},[a("span",{staticClass:"textOverflow disBlock textMaxWidth",attrs:{slot:"reference"},slot:"reference"},[t._v(t._s(e.content))])])],1),t._v(" "),a("td",{staticClass:"spanBox",on:{click:function(a){return t.watchFiles(e)}}},[t._v("查看")]),t._v(" "),a("td",[t._v(t._s(e.pubTime))]),t._v(" "),a("td",[t._v(t._s(e.pubOrg))]),t._v(" "),a("td",[t._v(t._s(e.createTime))]),t._v(" "),a("td",[t._v(t._s(e.pubUser))]),t._v(" "),a("td",[t._v(t._s(e.updateTime))]),t._v(" "),a("td",[t._v(t._s(e.updater))])])})],2)])])],1),t._v(" "),a("div",{staticClass:"flexCenter pageBox"},[a("Page",{attrs:{total:t.rowCount,"page-size":t.pageSize,current:t.currentpage,"show-elevator":"","show-sizer":""},on:{"on-change":t.pageChange,"on-page-size-change":t.pageSizefun,"update:current":function(e){t.currentpage=e}}})],1)],1)])]),t._v(" "),a("Modal",{staticClass:"dialog",attrs:{"mask-closable":!1,title:t.modelTitle,styles:{width:t.percentWidth}},on:{"on-cancel":t.cancel},model:{value:t.showModal,callback:function(e){t.showModal=e},expression:"showModal"}},[a(t.tabview,{key:t.keyId,ref:"dialogModal",tag:"component",attrs:{"file-obj":t.dataObj,"data-obj":t.dataObj},on:{cancel:t.cancelDialog,save:t.saveDatas}}),t._v(" "),a("div",{attrs:{slot:"footer"},slot:"footer"})],1)],1)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("span",{staticClass:"topTitle-span1"},[e("img",{attrs:{src:a("Dh6M"),alt:""}})])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"contentCellTitle"},[e("div",{staticClass:"contentCellTitle-1"}),this._v("查询条件\n      ")])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"contentCellTitle"},[e("div",{staticClass:"contentCellTitle-1"}),this._v("数据列表\n          ")])}]},d=a("C7Lr")(r,c,!1,null,null,null);e.default=d.exports},t7l9:function(t,e,a){"use strict";var i=a("ZLEe"),s=a.n(i),n={props:["dataObj"],components:{showUsualFiles:a("lvfI").a},data:function(){return{keyId:"",resData:{},fileObj:{}}},created:function(){if(s()(this.dataObj.data).length>0){var t=this.dataObj.data;t&&t.id&&(this.dataObj&&this.dataObj.infViewNum?this.getInfInfoRowNum(t.id):this.getInfInfoRow(t.id))}},methods:{getInfInfoRow:function(t){var e=this;this.axios.post("/process/infInfo/getInfInfoRow/"+t+"?decode=1",{headers:{"Content-Type":"application/json"}}).then(function(t){"200"==t.code&&(e.resData=t.data,e.resData.createTime=e.resData.createTime.substr(0,19),e.keyId=t.data.busId,e.fileObj={data:t.data,showFlag:!1})}).catch(function(t){})},getInfInfoRowNum:function(t){var e=this;this.axios.post("/process/infInfo/getInfInfoRow/"+t+"?infViewNum=1",{headers:{"Content-Type":"application/json"}}).then(function(t){"200"==t.code&&(e.resData=t.data,e.resData.createTime=e.resData.createTime.substr(0,19),e.keyId=t.data.busId,e.fileObj={data:t.data,showFlag:!1})}).catch(function(t){})}}},o={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"common-detail"},[a("div",{staticClass:"content"},[a("Form",{attrs:{"label-width":120}},[a("FormItem",{attrs:{label:"标题："}},[a("label",[t._v(t._s(t.resData.title))])]),t._v(" "),a("FormItem",{attrs:{label:"是否公开："}},[a("label",[t._v(t._s("true"==t.resData.ifShow?"是":"否"))])]),t._v(" "),a("FormItem",{attrs:{label:"发布机构："}},[a("label",[t._v(t._s(t.resData.pubOrg))])]),t._v(" "),a("FormItem",{attrs:{label:"发布时间："}},[a("label",[t._v(t._s(t.resData.createTime))])]),t._v(" "),a("FormItem",{attrs:{label:"编辑内容："}},[a("label",[t._v(t._s(t.resData.content))])]),t._v(" "),a("FormItem",{attrs:{label:"附件："}},[a("showUsualFiles",{key:t.keyId,attrs:{"file-obj":t.fileObj}})],1)],1)],1)])},staticRenderFns:[]},l=a("C7Lr")(n,o,!1,null,null,null);e.a=l.exports}});
//# sourceMappingURL=29.d052744a93de5540bc0c1577069638620.js.map