webpackJsonp([36],{IRWE:function(t,a){},LejN:function(t,a){},pwm9:function(t,a,e){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var s={components:{},props:["dataObj"],created:function(){},data:function(){return{modelData:{},paramData:{},form1EditFlg1:!1,form1EditFlg2:!1,ruleValidate1:{MaxIter:[],MaxDepth:[]},ruleValidate2:{sampleTable:[{required:!0,message:"必填！",trigger:"blur"}],splitRatio:[],featureColumn:[{required:!0,message:"必填！",trigger:"blur"}],labelColumn:[{required:!0,message:"必填！",trigger:"blur"}],forecastTable:[{required:!0,message:"必填！",trigger:"blur"}]}}},mounted:function(){this.doLoadData()},watch:{dataObj:function(t){this.doLoadData()}},methods:{handleCancel:function(t){1==t?this.form1EditFlg1=!this.form1EditFlg1:2==t&&(this.form1EditFlg2=!this.form1EditFlg2)},doLoadData:function(){var t=this;this.axios.get("/modeling/get/"+this.dataObj.id).then(function(a){a.data&&(t.modelData=a.data,t.paramData=JSON.parse(a.data.algorithmParam),t.form1EditFlg1=!1,t.form1EditFlg2=!1)}).catch(function(t){console.log(t)})},handleSubmit:function(t){var a=this,e="modelData";1==t&&(e="paramData");var s=!0;if(this.$refs[e].validate(function(t){s=t}),s){var n={};n=2==t?{id:this.modelData.id,sampleTable:this.modelData.sampleTable,splitRatio:this.modelData.splitRatio,featureColumn:this.modelData.featureColumn,labelColumn:this.modelData.labelColumn,forecastTable:this.modelData.forecastTable}:{id:this.modelData.id,algorithmParam:'{"MaxIter":'+this.paramData.MaxIter+',"MaxDepth":'+this.paramData.MaxDepth+"}"},this.axios.post("/modeling/save/"+this.modelData.id,n,{headers:{"Content-Type":"application/json"}}).then(function(e){a.$Message.success("保存成功"),a.handleCancel(t)}).catch(function(t){})}}}},n={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"model-detail"},[t._m(0),t._v(" "),e("div",{staticClass:"content"},[e("div",{directives:[{name:"show",rawName:"v-show",value:!t.form1EditFlg1,expression:"!form1EditFlg1"}]},[e("div",{staticClass:"content-detail"},[e("span",[t._v("模型代码："+t._s(t.modelData.modelCode))]),t._v(" "),e("span",[t._v("模型名称："+t._s(t.modelData.modelName))]),t._v(" "),e("span",[t._v("模型类型："+t._s(t.modelData.modelTypeStr))]),t._v(" "),e("span",[t._v("模型算法："+t._s(t.modelData.modelAlgorithmStr))])])])]),t._v(" "),t._m(1),t._v(" "),e("div",{staticClass:"content"},[3!=t.modelData.status?e("div",{staticClass:"create-content",on:{click:function(a){return t.handleCancel(1)}}},[e("Icon",{attrs:{type:"ios-create-outline"}}),t._v("编辑\n    ")],1):t._e(),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:!t.form1EditFlg1,expression:"!form1EditFlg1"}]},[e("div",{staticClass:"content-detail"},[e("span",[t._v("树的棵数："+t._s(t.paramData.MaxIter))]),t._v(" "),e("span",[t._v("树的最大深度："+t._s(t.paramData.MaxDepth))])])]),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:t.form1EditFlg1,expression:"form1EditFlg1"}]},[e("Form",{ref:"paramData",staticClass:"form-content",attrs:{model:t.paramData,rules:t.ruleValidate1,"label-width":120}},[e("Col",{attrs:{span:"12"}},[e("FormItem",{attrs:{label:"树的棵数",prop:"MaxIter"}},[e("Input-number",{attrs:{max:50,min:5},model:{value:t.paramData.MaxIter,callback:function(a){t.$set(t.paramData,"MaxIter",a)},expression:"paramData.MaxIter"}})],1)],1),t._v(" "),e("Col",{attrs:{span:"12"}},[e("FormItem",{attrs:{label:"树的最大深度",prop:"MaxDepth"}},[e("Input-number",{attrs:{max:20,min:1},model:{value:t.paramData.MaxDepth,callback:function(a){t.$set(t.paramData,"MaxDepth",a)},expression:"paramData.MaxDepth"}})],1)],1),t._v(" "),e("Col",{attrs:{span:"12"}},[e("FormItem",[e("div",{staticClass:"button-content"},[e("Button",{attrs:{type:"primary"},on:{click:function(a){return t.handleSubmit(1)}}},[t._v("保存")]),t._v(" "),e("Button",{on:{click:function(a){return t.handleCancel(1)}}},[t._v("取消")])],1)])],1)],1)],1)]),t._v(" "),t._m(2),t._v(" "),e("div",{staticClass:"content"},[3!=t.modelData.status?e("div",{staticClass:"create-content",on:{click:function(a){return t.handleCancel(2)}}},[e("Icon",{attrs:{type:"ios-create-outline"}}),t._v("编辑\n    ")],1):t._e(),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:!t.form1EditFlg2,expression:"!form1EditFlg2"}]},[e("div",{staticClass:"content-detail"},[e("span",[t._v("样本集："+t._s(t.modelData.sampleTable))]),t._v(" "),e("span",[t._v("数据拆分比："+t._s(t.modelData.splitRatio)+"%")]),t._v(" "),e("span",[t._v("特征列："+t._s(t.modelData.featureColumn))]),t._v(" "),e("span",[t._v("目标列："+t._s(t.modelData.labelColumn))]),t._v(" "),e("span",[t._v("预测集："+t._s(t.modelData.forecastTable))])])]),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:t.form1EditFlg2,expression:"form1EditFlg2"}]},[e("Form",{ref:"modelData",staticClass:"form-content",attrs:{model:t.modelData,rules:t.ruleValidate2,"label-width":120}},[e("Col",{attrs:{span:"12"}},[e("FormItem",{attrs:{label:"样本集",prop:"sampleTable"}},[e("Input",{model:{value:t.modelData.sampleTable,callback:function(a){t.$set(t.modelData,"sampleTable",a)},expression:"modelData.sampleTable"}})],1)],1),t._v(" "),e("Col",{attrs:{span:"12"}},[e("FormItem",{attrs:{label:"数据拆分比",prop:"splitRatio"}},[e("Input-number",{model:{value:t.modelData.splitRatio,callback:function(a){t.$set(t.modelData,"splitRatio",a)},expression:"modelData.splitRatio"}})],1)],1),t._v(" "),e("Col",{attrs:{span:"22"}},[e("FormItem",{attrs:{label:"特征列",prop:"featureColumn"}},[e("Input",{staticStyle:{width:"600px"},model:{value:t.modelData.featureColumn,callback:function(a){t.$set(t.modelData,"featureColumn",a)},expression:"modelData.featureColumn"}})],1)],1),t._v(" "),e("Col",{attrs:{span:"12"}},[e("FormItem",{attrs:{label:"目标列",prop:"labelColumn"}},[e("Input",{model:{value:t.modelData.labelColumn,callback:function(a){t.$set(t.modelData,"labelColumn",a)},expression:"modelData.labelColumn"}})],1)],1),t._v(" "),e("Col",{attrs:{span:"12"}},[e("FormItem",{attrs:{label:"预测集",prop:"forecastTable"}},[e("Input",{model:{value:t.modelData.forecastTable,callback:function(a){t.$set(t.modelData,"forecastTable",a)},expression:"modelData.forecastTable"}})],1)],1),t._v(" "),e("Col",{attrs:{span:"12"}},[e("FormItem",[e("div",{staticClass:"button-content"},[e("Button",{attrs:{type:"primary"},on:{click:function(a){return t.handleSubmit(2)}}},[t._v("保存")]),t._v(" "),e("Button",{on:{click:function(a){return t.handleCancel(2)}}},[t._v("取消")])],1)])],1)],1)],1)])])},staticRenderFns:[function(){var t=this.$createElement,a=this._self._c||t;return a("div",{staticClass:"contentCellTitle"},[a("div",{staticClass:"contentCellTitle-1"}),this._v("基础信息\n  ")])},function(){var t=this.$createElement,a=this._self._c||t;return a("div",{staticClass:"contentCellTitle"},[a("div",{staticClass:"contentCellTitle-1"}),this._v("算法参数\n  ")])},function(){var t=this.$createElement,a=this._self._c||t;return a("div",{staticClass:"contentCellTitle"},[a("div",{staticClass:"contentCellTitle-1"}),this._v("预测数据\n  ")])}]};var o={components:{},props:["dataObj"],created:function(){},data:function(){return{evaluator:{},chartXAxisData:["召回率(Recall)","TPR(Sensitivity)","精准率(Precision)","NPV","准确率(Accuracy)","F1-Score"],chartSeriesData:[]}},mounted:function(){var t=this;this.axios.get("/modeling/assess/"+this.dataObj.id).then(function(a){a.data&&(t.evaluator=JSON.parse(a.data.evaluator),t.chartSeriesData=[t.evaluator.recall,t.evaluator.sensitivity,t.evaluator.precision,t.evaluator.NPV,t.evaluator.accuracy,t.evaluator.f1Score],t.drawLine())}).catch(function(t){})},watch:{dataObj:function(t){var a=this;this.axios.get("/modeling/assess/"+t.id).then(function(t){t.data&&(a.evaluator=JSON.parse(t.data.evaluator),a.chartSeriesData=[a.evaluator.recall,a.evaluator.sensitivity,a.evaluator.precision,a.evaluator.NPV,a.evaluator.accuracy,a.evaluator.f1Score],a.drawLine())}).catch(function(t){})}},methods:{drawLine:function(){this.$echarts.init(this.$refs.main).setOption({color:["#3398DB"],xAxis:{data:this.chartXAxisData,axisLabel:{interval:0,rotate:30}},yAxis:{min:0,max:1,splitNumber:5},series:[{type:"bar",barWidth:40,label:{normal:{show:!0,position:"top"}},data:this.chartSeriesData}]})}}},l={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"assess-report"},[e("div",{staticClass:"contentCellBox"},[e("div",{staticClass:"contentCellBox"},[e("div",{staticClass:"contentCellBody"},[e("table",{staticStyle:{"text-align":"center","font-weight":"bold",width:"400px",height:"160px"},attrs:{align:"center"}},[e("caption",[t._v("混淆矩阵与评估指标")]),t._v(" "),t._m(0),t._v(" "),e("tr",[e("td",[t._v("实际值(正)")]),t._v(" "),e("td",{staticStyle:{background:"#E0FFFF"}},[t._v(t._s(t.evaluator.TP))]),t._v(" "),e("td",{staticStyle:{background:"#AFEEEE"}},[t._v(t._s(t.evaluator.FN))]),t._v(" "),e("td",{staticStyle:{background:"#F0FFFF"}},[t._v(t._s(t.evaluator.NTS))])]),t._v(" "),e("tr",[e("td",[t._v("实际值(负)")]),t._v(" "),e("td",{staticStyle:{background:"#AFEEEE"}},[t._v(t._s(t.evaluator.FP))]),t._v(" "),e("td",{staticStyle:{background:"#E0FFFF"}},[t._v(t._s(t.evaluator.TN))]),t._v(" "),e("td",{staticStyle:{background:"#F0FFFF"}},[t._v(t._s(t.evaluator.NFS))])]),t._v(" "),e("tr",[e("td",[t._v("总数")]),t._v(" "),e("td",{staticStyle:{background:"#F0FFFF"}},[t._v(t._s(t.evaluator.PTS))]),t._v(" "),e("td",{staticStyle:{background:"#F0FFFF"}},[t._v(t._s(t.evaluator.PFS))]),t._v(" "),e("td",[t._v(" ")])])]),t._v(" "),e("div",{ref:"main",staticStyle:{height:"300px"}})])])])])},staticRenderFns:[function(){var t=this.$createElement,a=this._self._c||t;return a("tr",[a("td",{staticStyle:{width:"25%"}}),this._v(" "),a("td",{staticStyle:{width:"25%"}},[this._v("模型预测(正)")]),this._v(" "),a("td",{staticStyle:{width:"25%"}},[this._v("模型预测(负)")]),this._v(" "),a("td",{staticStyle:{width:"25%"}},[this._v("总数")])])}]};var i={components:{modelDetail:e("C7Lr")(s,n,!1,function(t){e("LejN")},"data-v-319cf53a",null).exports,assessReport:e("C7Lr")(o,l,!1,function(t){e("IRWE")},"data-v-98335a8a",null).exports},props:["dataObj"]},r={render:function(){var t=this.$createElement,a=this._self._c||t;return a("div",[a("Tabs",{attrs:{type:"card"}},[a("TabPane",{attrs:{label:"模型详情"}},[a("modelDetail",{attrs:{dataObj:this.dataObj}})],1),this._v(" "),a("TabPane",{attrs:{label:"二分类评估报告"}},[a("assessReport",{attrs:{dataObj:this.dataObj}})],1)],1)],1)},staticRenderFns:[]},c=e("C7Lr")(i,r,!1,null,null,null).exports,d={props:["dataObj"],data:function(){return{tableHeader:[{name:"序"},{name:"参数名"},{name:"参数值"}],tableBody:{}}},mounted:function(){var t=this;this.axios.get("/modeling/modelRecord/"+this.dataObj.id).then(function(a){a.data&&(t.tableBody=a.data)}).catch(function(t){console.log(t)})},watch:{dataObj:function(t){var a=this;this.axios.get("/modeling/modelRecord/"+this.dataObj.id).then(function(t){t.data&&(a.tableBody=t.data)}).catch(function(t){console.log(t)})}}},u={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"param-dialog"},[e("div",{staticClass:"contentCellBody"},[e("Row",[e("table",{staticClass:"tableBox"},[e("thead",[e("tr",t._l(t.tableHeader,function(a,s){return e("td",[t._v(t._s(a.name))])}),0)]),t._v(" "),e("tbody",[t._l(t.tableBody.algorithmParamJason,function(a,s,n){return[e("tr",[e("td",[t._v(t._s(n+1))]),t._v(" "),e("td",[t._v(t._s(s))]),t._v(" "),e("td",[t._v(t._s(a))])])]})],2)])])],1)])},staticRenderFns:[]},v={components:{paramDialog:e("C7Lr")(d,u,!1,null,null,null).exports},props:["dataObj"],data:function(){return{dataObj:{},dataObj2:{id:1},showModal:!1,tableHeader:[{name:"序"},{name:"模型代码"},{name:"模型名称"},{name:"AUC"},{name:"精准率"},{name:"召回率"},{name:"执行开始时间\t"},{name:"执行结束时间"},{name:"运行状态"},{name:"操作"}],tableBody:[]}},mounted:function(){var t=this;this.axios.get("/modeling/modelRecords?id="+this.dataObj.id).then(function(a){a.data&&(t.tableBody=a.data)}).catch(function(t){console.log(t)})},watch:{dataObj:function(t){var a=this;this.axios.get("/modeling/modelRecords?id="+this.dataObj.id).then(function(t){t.data&&(a.tableBody=t.data)}).catch(function(t){console.log(t)})}},methods:{operate:function(t){this.showModal=!0,this.dataObj2={id:t}},cancel:function(){}}},m={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"vertify-records"},[e("div",{staticClass:"contentCellBody"},[e("Row",[e("table",{staticClass:"tableBox"},[e("thead",[e("tr",t._l(t.tableHeader,function(a,s){return e("td",[t._v(t._s(a.name))])}),0)]),t._v(" "),e("tbody",[t._l(t.tableBody,function(a,s){return[e("tr",[e("td",[t._v(t._s(s+1))]),t._v(" "),e("td",[t._v(t._s(a.modelCode))]),t._v(" "),e("td",[t._v(t._s(a.modelName))]),t._v(" "),e("td",[t._v(t._s(a.evaluatorJson.AUC))]),t._v(" "),e("td",[t._v(t._s(a.evaluatorJson.precision))]),t._v(" "),e("td",[t._v(t._s(a.evaluatorJson.recall))]),t._v(" "),e("td",[t._v(t._s(a.begTime))]),t._v(" "),e("td",[t._v(t._s(a.endTime))]),t._v(" "),e("td",[t._v(t._s(a.statusStr))]),t._v(" "),e("td",[e("span",{staticClass:"spanBox",on:{click:function(e){return t.operate(a.id)}}},[t._v("参数")])])])]})],2)])])],1),t._v(" "),e("Modal",{staticClass:"dialog",attrs:{"mask-closable":!1,title:"参数",styles:{width:"40%"}},on:{"on-cancel":t.cancel},model:{value:t.showModal,callback:function(a){t.showModal=a},expression:"showModal"}},[e("paramDialog",{attrs:{dataObj:t.dataObj2}}),t._v(" "),e("div",{attrs:{slot:"footer"},slot:"footer"})],1)],1)},staticRenderFns:[]},_={components:{modelDialog:c,vertifyRecords:e("C7Lr")(v,m,!1,null,null,null).exports},created:function(){this.loadData()},data:function(){return{tabview:"",showModal:!1,dataObj:{},modelTitle:"",tableHeader:[{name:"序"},{name:"模型代码"},{name:"模型名称"},{name:"模型类型"},{name:"模型算法"},{name:"状态"},{name:"创建时间"},{name:"实验时间"},{name:"上线时间"},{name:"操作"}],tableBody:[{}]}},mounted:function(){},methods:{cancel:function(){},showModel:function(t,a){var e=this;"0"==a?(this.modelTitle="模型详情",this.tabview="modelDialog",this.showModal=!0,this.dataObj={id:t}):"1"==a?this.$Modal.confirm({title:"确认对话框",content:"<p>请确认，训练模型？</p>",onOk:function(){e.doTraining(t)},onCancel:function(){}}):"2"==a?this.$Modal.confirm({title:"确认对话框",content:"<p>请确认，部署模型？</p>",onOk:function(){e.doPublish(t)},onCancel:function(){}}):"3"==a?this.$Modal.confirm({title:"确认对话框",content:"<p>请确认，下架模型？</p>",onOk:function(){e.doOffline(t)},onCancel:function(){}}):"5"==a&&(this.modelTitle="训练记录",this.tabview="vertifyRecords",this.showModal=!0,this.dataObj={id:t})},saveDatas:function(){},cancelDialog:function(){},loadData:function(){var t=this;this.axios.get("/modeling/list").then(function(a){a.data&&(t.tableBody=a.data)}).catch(function(t){})},doTraining:function(t){var a=this;this.axios.get("/modeling/training/"+t).then(function(t){a.$Message.success("成功提交后台处理模型训练！"),a.loadData()}).catch(function(t){a.$Message.error("提交模型训练失败！")})},doPublish:function(t){var a=this;this.axios.get("/modeling/publish/"+t).then(function(t){a.$Message.success("部署模型成功！"),a.loadData()}).catch(function(t){a.$Message.error("部署模型失败！")})},doOffline:function(t){var a=this;this.axios.get("/modeling/offline/"+t).then(function(t){a.$Message.success("下架模型成功！"),a.loadData()}).catch(function(t){a.$Message.error("下架模型失败！")})}}},h={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",[t._m(0),t._v(" "),e("div",{staticClass:"contentCellBox"},[e("div",{staticClass:"contentCellBox"},[t._m(1),t._v(" "),e("div",{staticClass:"contentCellBody"},[e("Row",[e("table",{staticClass:"tableBox"},[e("thead",[e("tr",t._l(t.tableHeader,function(a,s){return e("td",[t._v(t._s(a.name))])}),0)]),t._v(" "),e("tbody",[t._l(t.tableBody,function(a,s){return[e("tr",[e("td",[t._v(t._s(s+1))]),t._v(" "),e("td",[t._v(t._s(a.modelCode))]),t._v(" "),e("td",[t._v(t._s(a.modelName))]),t._v(" "),e("td",[t._v(t._s(a.modelTypeStr))]),t._v(" "),e("td",[t._v(t._s(a.modelAlgorithm))]),t._v(" "),e("td",[t._v(t._s(a.statusStr))]),t._v(" "),e("td",[t._v(t._s(a.createTime))]),t._v(" "),e("td",[t._v(t._s(a.experiBegTime)+"~"+t._s(a.experiEndTime))]),t._v(" "),e("td",[t._v(t._s(a.deployTime))]),t._v(" "),e("td",[e("span",{staticClass:"spanBox",on:{click:function(e){return t.showModel(a.id,0)}}},[t._v("模型详情")]),t._v(" "),3!=a.status?e("span",{staticClass:"spanBox",on:{click:function(e){return t.showModel(a.id,1)}}},[t._v("训练模型")]):t._e(),t._v(" "),2==a.status?e("span",{staticClass:"spanBox",on:{click:function(e){return t.showModel(a.id,2)}}},[t._v("部署模型")]):t._e(),t._v(" "),3==a.status?e("span",{staticClass:"spanBox",on:{click:function(e){return t.showModel(a.id,3)}}},[t._v("下架模型")]):t._e(),t._v(" "),0!=a.status?e("span",{staticClass:"spanBox",on:{click:function(e){return t.showModel(a.id,5)}}},[t._v("训练记录")]):t._e()])])]})],2)])])],1)])]),t._v(" "),e("Modal",{staticClass:"dialog",attrs:{"mask-closable":!1,title:t.modelTitle,styles:{width:"60%"}},on:{"on-cancel":t.cancel},model:{value:t.showModal,callback:function(a){t.showModal=a},expression:"showModal"}},[e(t.tabview,{tag:"component",attrs:{dataObj:t.dataObj},on:{cancel:t.cancelDialog,save:t.saveDatas}}),t._v(" "),e("div",{attrs:{slot:"footer"},slot:"footer"})],1)],1)},staticRenderFns:[function(){var t=this.$createElement,a=this._self._c||t;return a("div",{staticClass:"topTitle"},[a("span",{staticClass:"topTitle-span1"},[this._v("机器学习")]),this._v(" "),a("span",{staticClass:"topTitle-span1"},[a("img",{attrs:{src:e("Dh6M"),alt:""}})]),this._v(" "),a("span",{staticClass:"topTitle-span1"},[this._v("机器学习建模")])])},function(){var t=this.$createElement,a=this._self._c||t;return a("div",{staticClass:"contentCellTitle"},[a("div",{staticClass:"contentCellTitle-1"}),this._v("机器学习建模\n        "),a("div",{staticClass:"button-content"})])}]},p=e("C7Lr")(_,h,!1,null,null,null);a.default=p.exports}});
//# sourceMappingURL=36.51d04c5dc70568bd09c61577069638620.js.map